<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>瑞桉旅游团队用车统计系统</title>
    <style>
        @font-face {
            font-family: 'Microsoft YaHei';
            src: local('Microsoft YaHei');
        }
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            font-size: 10.5pt;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            background-image: url('https://images.unsplash.com/photo-1506929562872-bb421503ef21?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
        }
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.5);
        }
        .login-box {
            background-color: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
            text-align: center;
            width: 300px;
        }
        .login-box h2 {
            color: #ff6b6b;
            margin-bottom: 20px;
        }
        .login-box input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: 'Microsoft YaHei';
        }
        .login-box button {
            background-color: #ff6b6b;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Microsoft YaHei';
            width: 100%;
            margin-top: 10px;
        }
        .container {
            display: none;
            max-width: 100%;
            padding: 10px;
        }
        .header {
            background-color: #ff6b6b;
            color: white;
            padding: 15px;
            text-align: center;
            border-radius: 5px 5px 0 0;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .filter-bar {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .filter-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 5px;
        }
        .filter-item {
            display: flex;
            align-items: center;
        }
        .filter-item label {
            margin-right: 5px;
            font-weight: bold;
            color: #555;
        }
        .filter-item select {
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-family: 'Microsoft YaHei';
            font-size: 10.5pt;
        }
        .active-filters {
            background-color: #fffde7;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            border-left: 4px solid #ffc107;
        }
        .active-filters span {
            background-color: #ffc107;
            padding: 2px 5px;
            border-radius: 3px;
            margin-right: 5px;
            display: inline-block;
            margin-bottom: 5px;
        }
        .table-container {
            overflow-x: auto;
            margin-bottom: 20px;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 6px;
            text-align: center;
            word-wrap: break-word;
        }
        th {
            background-color: #ff6b6b;
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .fixed-column {
            position: sticky;
            left: 0;
            z-index: 5;
            background-color: #ff6b6b;
            color: white;
        }
        .fixed-column-season {
            position: sticky;
            left: 80px;
            z-index: 5;
            background-color: #ff8a65;
            color: white;
        }
        .fixed-column-type {
            position: sticky;
            left: 160px;
            z-index: 5;
            background-color: #ff7043;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        tr:hover {
            background-color: #f1f1f1;
        }
        .empty-return {
            color: #c62828;
            font-weight: bold;
        }
        .summary-box {
            background-color: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            border-left: 4px solid #2196f3;
        }
        .summary-box h3 {
            margin-top: 0;
            color: #1565c0;
        }
        .summary-value {
            font-size: 18px;
            font-weight: bold;
            color: #c62828;
            margin: 10px 0;
        }
        .home-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #ff6b6b;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 100;
        }
        @media (max-width: 768px) {
            .filter-row {
                flex-direction: column;
            }
            .filter-item {
                width: 100%;
            }
            .filter-item select {
                width: 100%;
            }
            th, td {
                font-size: 9pt;
                padding: 4px;
            }
            .fixed-column, .fixed-column-season, .fixed-column-type {
                position: static;
                background-color: inherit;
                color: inherit;
            }
        }
    </style>
</head>
<body>
    <div class="login-container" id="loginContainer">
        <div class="login-box">
            <h2>瑞桉旅游团队用车统计系统</h2>
            <input type="text" id="username" placeholder="用户名">
            <input type="password" id="password" placeholder="密码">
            <button onclick="login()">登录</button>
        </div>
    </div>

    <div class="container" id="mainContainer">
        <div class="header">
            <h1>瑞桉旅游团队用车统计系统</h1>
        </div>

        <div class="filter-bar">
            <div class="filter-row">
                <div class="filter-item">
                    <label for="region-filter">区域:</label>
                    <select id="region-filter">
                        <option value="">全部</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label for="season-filter">季节:</label>
                    <select id="season-filter">
                        <option value="">全部</option>
                        <option value="淡季">淡季</option>
                        <option value="旺季">旺季</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label for="type-filter">车型:</label>
                    <select id="type-filter">
                        <option value="">全部</option>
                        <option value="大巴">大巴</option>
                        <option value="中巴">中巴</option>
                        <option value="迷你巴">迷你巴</option>
                    </select>
                </div>
            </div>
            <div class="filter-row">
                <div class="filter-item">
                    <label for="supplier-filter">供应商:</label>
                    <select id="supplier-filter">
                        <option value="">全部</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label for="group-filter">团号:</label>
                    <select id="group-filter">
                        <option value="">全部</option>
                    </select>
                </div>
                <div class="filter-item">
                    <button onclick="resetFilters()" style="background-color: #9e9e9e;">重置</button>
                </div>
            </div>
        </div>

        <div class="active-filters" id="activeFilters">
            <p>当前筛选条件: <span id="filters-display">无</span></p>
        </div>

        <div class="table-container">
            <table id="data-table">
                <thead>
                    <tr>
                        <th class="fixed-column">区域</th>
                        <th class="fixed-column-season">季节</th>
                        <th class="fixed-column-type">车型</th>
                        <th>无空</th>
                        <th>空返</th>
                        <th>预定价(€)</th>
                        <th>无空日均(€)</th>
                        <th>空返日均(€)</th>
                        <th>供应商</th>
                        <th>参考总价(€)</th>
                        <th>参考日均(€)</th>
                        <th>参考总价(€)</th>
                        <th>参考日均(€)</th>
                        <th>团号</th>
                        <th>抵达日期</th>
                        <th>离开日期</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    <!-- Data will be inserted here by JavaScript -->
                </tbody>
            </table>
        </div>

        <div class="summary-box">
            <h3>空返日均价格汇总</h3>
            <div class="summary-value" id="empty-return-summary">€0</div>
            <p>以上为当前筛选条件下的空返日均价格平均值</p>
        </div>

        <div class="home-btn" onclick="scrollToTop()">
            ↑
        </div>
    </div>

    <script>
        // 完整数据从Excel导入
        const data = [
            { 区域: "拉脱维亚", 季节: "淡季", 车型: "大巴", 无空: 3, 空返: 3, 预定价: 1400, 无空日均: 467, 空返日均: 467, 供应商: "里加 Viva Auto", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK25030170121011", 抵达日期: "2025-01-21", 离开日期: "2025-01-24" },
            { 区域: "免四BB", 季节: "淡季", 车型: "中巴", 无空: 7.5, 空返: 7.5, 预定价: 2700, 无空日均: 360, 空返日均: 360, 供应商: "诺维萨德 RT travel", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503003B0125020-1", 抵达日期: "2025-01-25", 离开日期: "2025-02-01" },
            { 区域: "波兰", 季节: "淡季", 车型: "大巴", 无空: 9, 空返: 9, 预定价: 4200, 无空日均: 467, 空返日均: 467, 供应商: "克拉科夫 szwagropol", 参考总价: 4600, 参考日均: 511, 参考总价2: 6800, 参考日均2: 756, 团号: "EE2503011A2600010-1", 抵达日期: "2025-01-28", 离开日期: "2025-02-05" },
            { 区域: "免四BB", 季节: "淡季", 车型: "大巴", 无空: 8.5, 空返: 8.5, 预定价: 3200, 无空日均: 376, 空返日均: 376, 供应商: "诺维萨德 RT travel", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK13009A250202025-1", 抵达日期: "2025-02-03", 离开日期: "2025-02-11" },
            { 区域: "奥匈南", 季节: "淡季", 车型: "大巴", 无空: 18.5, 空返: 20, 预定价: 8700, 无空日均: 470, 空返日均: 435, 供应商: "贝尔格莱德 ALENIK", 参考总价: 10500, 参考日均: 568, 参考总价2: 11800, 参考日均2: 590, 团号: "BK13122A250313027-1", 抵达日期: "2025-03-14", 离开日期: "2025-04-01" },
            { 区域: "奥匈南", 季节: "淡季", 车型: "大巴", 无空: 11.5, 空返: 13, 预定价: 5800, 无空日均: 504, 空返日均: 446, 供应商: "苏博蒂查 Sutravel", 参考总价: 6700, 参考日均: 583, 参考总价2: 6800, 参考日均2: 523, 团号: "BE2503003B0314019-1", 抵达日期: "2025-03-14", 离开日期: "2025-03-25" },
            { 区域: "阿尔巴尼亚", 季节: "淡季", 车型: "迷你巴", 无空: 2.5, 空返: 2.5, 预定价: 930, 无空日均: 372, 空返日均: 372, 供应商: "地拉那 Bus Rental", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503003V0327006", 抵达日期: "2025-03-27", 离开日期: "2025-03-29" },
            { 区域: "巴尔干", 季节: "淡季", 车型: "大巴", 无空: 15.5, 空返: 17, 预定价: 7200, 无空日均: 465, 空返日均: 424, 供应商: "萨拉热窝 VILDAN", 参考总价: 9500, 参考日均: 613, 参考总价2: "无", 参考日均2: "无", 团号: "BK13122A250327027-1", 抵达日期: "2025-03-30", 离开日期: "2025-04-14" },
            { 区域: "匈牙利", 季节: "淡季", 车型: "大巴", 无空: 7, 空返: 7, 预定价: 4900, 无空日均: 700, 空返日均: 700, 供应商: "布达佩斯 Szekeres", 参考总价: 4950, 参考日均: 707, 参考总价2: 5156, 参考日均2: 737, 团号: "EE2509001B0413010", 抵达日期: "2025-04-13", 离开日期: "2025-04-19" },
            { 区域: "匈牙利", 季节: "淡季", 车型: "迷你巴", 无空: 7, 空返: 7, 预定价: 2585, 无空日均: 369, 空返日均: 369, 供应商: "布达佩斯 ContiBUS", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "EE2509001B0413010", 抵达日期: "2025-04-13", 离开日期: "2025-04-19" },
            { 区域: "克免三", 季节: "淡季", 车型: "大巴", 无空: 12, 空返: 13, 预定价: 5200, 无空日均: 433, 空返日均: 400, 供应商: "萨拉热窝 VILDAN", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK25030040410019-1", 抵达日期: "2025-04-15", 离开日期: "2025-04-26" },
            { 区域: "希边境", 季节: "淡季", 车型: "大巴", 无空: 14, 空返: 17, 预定价: 7500, 无空日均: 536, 空返日均: 441, 供应商: "诺维萨德 RT travel", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503008A0414020-1", 抵达日期: "2025-04-15", 离开日期: "2025-04-28" },
            { 区域: "匈克阿", 季节: "淡季", 车型: "迷你巴", 无空: 10.5, 空返: 10.5, 预定价: 5650, 无空日均: 538, 空返日均: 538, 供应商: "萨格勒布 Mandi", 参考总价: 6270, 参考日均: 597, 参考总价2: "无", 参考日均2: "无", 团号: "BK13056V250415010", 抵达日期: "2025-04-15", 离开日期: "2025-04-25" },
            { 区域: "奥匈南", 季节: "淡季", 车型: "大巴", 无空: 12, 空返: 13, 预定价: 6500, 无空日均: 542, 空返日均: 500, 供应商: "波黑 BN TRAVEL", 参考总价: 6700, 参考日均: 558, 参考总价2: 6800, 参考日均2: 523, 团号: "BE2503003B0418020-1", 抵达日期: "2025-04-18", 离开日期: "2025-04-29" },
            { 区域: "巴尔干", 季节: "淡季", 车型: "迷你巴", 无空: 21.5, 空返: 23, 预定价: 8100, 无空日均: 377, 空返日均: 352, 供应商: "诺维萨德 RT travel", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503012B0418020-1", 抵达日期: "2025-04-18", 离开日期: "2025-05-09" },
            { 区域: "巴尔干", 季节: "淡季", 车型: "大巴", 无空: 21.5, 空返: 23, 预定价: 9200, 无空日均: 428, 空返日均: 400, 供应商: "萨拉热窝 Vildan", 参考总价: 9500, 参考日均: 442, 参考总价2: "无", 参考日均2: "无", 团号: "BK2503012B0418020-1", 抵达日期: "2025-04-18", 离开日期: "2025-05-09" },
            { 区域: "黑山", 季节: "淡季", 车型: "迷你巴", 无空: 8, 空返: 8, 预定价: 2400, 无空日均: 300, 空返日均: 300, 供应商: "萨拉热窝 Lalatovic", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK13121A250418019-1", 抵达日期: "2025-04-18", 离开日期: "2025-04-25" },
            { 区域: "黑山", 季节: "淡季", 车型: "大巴", 无空: 8, 空返: 8, 预定价: 3120, 无空日均: 390, 空返日均: 390, 供应商: "萨拉热窝 Lalatovic", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK13121A250418019-1", 抵达日期: "2025-04-18", 离开日期: "2025-04-25" },
            { 区域: "东塞", 季节: "淡季", 车型: "迷你巴", 无空: 12, 空返: 12, 预定价: 4300, 无空日均: 358, 空返日均: 358, 供应商: "苏博蒂查 SuTravel", 参考总价: 4600, 参考日均: 383, 参考总价2: "无", 参考日均2: "无", 团号: "BK13086A250424010", 抵达日期: "2025-04-25", 离开日期: "2025-05-04" },
            { 区域: "匈克", 季节: "淡季", 车型: "迷你巴", 无空: 8, 空返: 9, 预定价: 3600, 无空日均: 450, 空返日均: 400, 供应商: "别洛瓦尔 Molnar", 参考总价: 4100, 参考日均: 513, 参考总价2: 4200, 参考日均2: 467, 团号: "BK13052A250425009", 抵达日期: "2025-04-25", 离开日期: "2025-05-02" },
            { 区域: "东欧", 季节: "淡季", 车型: "大巴", 无空: 17, 空返: 19, 预定价: 8950, 无空日均: 526, 空返日均: 471, 供应商: "克拉科夫 szwagropol", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "EE2503011A5600015-1", 抵达日期: "2025-04-29", 离开日期: "2025-05-15" },
            { 区域: "奥匈斯克", 季节: "旺季", 车型: "大巴", 无空: 10, 空返: 12, 预定价: 6220, 无空日均: 622, 空返日均: 518, 供应商: "萨格勒布 Gogobus", 参考总价: 6550, 参考日均: 655, 参考总价2: "无", 参考日均2: "无", 团号: "BK2503035A0501010-2", 抵达日期: "2025-05-01", 离开日期: "2025-05-10" },
            { 区域: "东欧", 季节: "旺季", 车型: "大巴", 无空: 9, 空返: 10, 预定价: 6950, 无空日均: 772, 空返日均: 695, 供应商: "布拉格 Bohemia", 参考总价: 7700, 参考日均: 856, 参考总价2: "无", 参考日均2: "无", 团号: "EE09001A250506010-1", 抵达日期: "2025-05-06", 离开日期: "2025-05-14" },
            { 区域: "白俄", 季节: "旺季", 车型: "迷你巴", 无空: 2.5, 空返: 2.5, 预定价: 500, 无空日均: 200, 空返日均: 200, 供应商: "明斯克", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "GBT2502045B0501008", 抵达日期: "2025-05-07", 离开日期: "2025-05-09" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "大巴", 无空: 22, 空返: 23, 预定价: 9500, 无空日均: 432, 空返日均: 413, 供应商: "诺维萨德 RT travel", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503003A0509019-1", 抵达日期: "2025-05-09", 离开日期: "2025-05-30" },
            { 区域: "德巴", 季节: "旺季", 车型: "大巴", 无空: 10.5, 空返: 12, 预定价: 9110, 无空日均: 868, 空返日均: 759, 供应商: "布拉格 rosti", 参考总价: 9600, 参考日均: 914, 参考总价2: "无", 参考日均2: "无", 团号: "BK2503039A0606018-1", 抵达日期: "2025-05-11", 离开日期: "2025-05-21" },
            { 区域: "东巴", 季节: "旺季", 车型: "大巴", 无空: 19, 空返: 20, 预定价: 10800, 无空日均: 568, 空返日均: 540, 供应商: "萨拉热窝 VILDAN", 参考总价: 12000, 参考日均: 632, 参考总价2: "无", 参考日均2: "无", 团号: "BK13019A250514031-1", 抵达日期: "2025-05-14", 离开日期: "2025-06-01" },
            { 区域: "克免三", 季节: "旺季", 车型: "大巴", 无空: 12, 空返: 12, 预定价: 5850, 无空日均: 488, 空返日均: 488, 供应商: "贝尔格莱德 Karlito", 参考总价: 6400, 参考日均: 533, 参考总价2: "无", 参考日均2: "无", 团号: "BK13060A250514020-1", 抵达日期: "2025-05-14", 离开日期: "2025-05-25" },
            { 区域: "奥匈南", 季节: "旺季", 车型: "大巴", 无空: 13.5, 空返: 15, 预定价: 7000, 无空日均: 519, 空返日均: 467, 供应商: "诺维萨德 RT travel", 参考总价: 7500, 参考日均: 556, 参考总价2: "无", 参考日均2: "无", 团号: "BK2503012B0516025-1", 抵达日期: "2025-05-16", 离开日期: "2025-05-29" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "大巴", 无空: 21.5, 空返: 23, 预定价: 10500, 无空日均: 488, 空返日均: 457, 供应商: "诺维萨德 RT travel", 参考总价: 11500, 参考日均: 535, 参考总价2: 12000, 参考日均2: 522, 团号: "BK2503013B0516020-1", 抵达日期: "2025-05-16", 离开日期: "2025-06-06" },
            { 区域: "波波", 季节: "旺季", 车型: "大巴", 无空: 17, 空返: 19, 预定价: 8350, 无空日均: 491, 空返日均: 439, 供应商: "维尔纽斯 UAB", 参考总价: 8500, 参考日均: 500, 参考总价2: "无", 参考日均2: "无", 团号: "BT03003B0516024-1", 抵达日期: "2025-05-16", 离开日期: "2025-06-01" },
            { 区域: "东欧", 季节: "旺季", 车型: "迷你巴", 无空: 15.5, 空返: 15.5, 预定价: 7160, 无空日均: 462, 空返日均: 462, 供应商: "布达佩斯 ContiBUS", 参考总价: 7700, 参考日均: 497, 参考总价2: "无", 参考日均2: "无", 团号: "BK13060A250516010-1", 抵达日期: "2025-05-16", 离开日期: "2025-05-31" },
            { 区域: "克罗地亚", 季节: "旺季", 车型: "大巴", 无空: 3.5, 空返: 3.5, 预定价: 1600, 无空日均: 457, 空返日均: 457, 供应商: "萨格勒布 GALOP", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503017D0521020", 抵达日期: "2025-05-21", 离开日期: "2025-05-24" },
            { 区域: "奥匈南", 季节: "旺季", 车型: "大巴", 无空: 12.5, 空返: 14, 预定价: 6500, 无空日均: 520, 空返日均: 464, 供应商: "贝尔格莱德 ALENIK", 参考总价: 7200, 参考日均: 576, 参考总价2: 7500, 参考日均2: 536, 团号: "BK13003A250506019-1", 抵达日期: "2025-05-22", 离开日期: "2025-06-03" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "大巴", 无空: 21.5, 空返: 23, 预定价: 8500, 无空日均: 395, 空返日均: 370, 供应商: "贝尔格莱德 ALENIK", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503003A0523020-1", 抵达日期: "2025-05-23", 离开日期: "2025-06-13" },
            { 区域: "波波", 季节: "旺季", 车型: "迷你巴", 无空: 12, 空返: 14, 预定价: 5000, 无空日均: 417, 空返日均: 357, 供应商: "维尔纽斯 UAB", 参考总价: 5500, 参考日均: 458, 参考总价2: "无", 参考日均2: "无", 团号: "GBT250524C004016-1", 抵达日期: "2025-05-24", 离开日期: "2025-06-04" },
            { 区域: "波波", 季节: "旺季", 车型: "大巴", 无空: 12, 空返: 14, 预定价: 6500, 无空日均: 542, 空返日均: 464, 供应商: "维尔纽斯 UAB", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "GBT250524C004016-1", 抵达日期: "2025-05-24", 离开日期: "2025-06-04" },
            { 区域: "波波", 季节: "旺季", 车型: "中巴", 无空: 12, 空返: 14, 预定价: 6000, 无空日均: 500, 空返日均: 429, 供应商: "维尔纽斯 UAB", 参考总价: 6600, 参考日均: 550, 参考总价2: "无", 参考日均2: "无", 团号: "GBT250524C004016-1", 抵达日期: "2025-05-24", 离开日期: "2025-06-04" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "大巴", 无空: 23, 空返: 23, 预定价: 10500, 无空日均: 457, 空返日均: 457, 供应商: "诺维萨德 RT travel", 参考总价: 12000, 参考日均: 522, 参考总价2: "无", 参考日均2: "无", 团号: "BK13121A250525019-1", 抵达日期: "2025-05-25", 离开日期: "2025-06-16" },
            { 区域: "德巴", 季节: "旺季", 车型: "大巴", 无空: 10.5, 空返: 12, 预定价: 9428, 无空日均: 898, 空返日均: 786, 供应商: "布拉格 rosti", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK13156A250523030-1", 抵达日期: "2025-05-25", 离开日期: "2025-06-04" },
            { 区域: "河轮", 季节: "旺季", 车型: "迷你巴", 无空: 16, 空返: 17, 预定价: 7000, 无空日均: 438, 空返日均: 412, 供应商: "苏博蒂查 Sutravel", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BE2503003B0527030-1", 抵达日期: "2025-05-27", 离开日期: "2025-06-11" },
            { 区域: "波三", 季节: "旺季", 车型: "大巴", 无空: 6.5, 空返: 7, 预定价: 3400, 无空日均: 523, 空返日均: 486, 供应商: "维尔纽斯 UAB", 参考总价: 3920, 参考日均: 603, 参考总价2: "无", 参考日均2: "无", 团号: "BK03011A052812-1", 抵达日期: "2025-05-28", 离开日期: "2025-06-03" },
            { 区域: "保罗", 季节: "旺季", 车型: "大巴", 无空: 7, 空返: 8, 预定价: 3550, 无空日均: 507, 空返日均: 444, 供应商: "索非亚 georama", 参考总价: 3940, 参考日均: 563, 参考总价2: 4300, 参考日均2: 538, 团号: "BK2503003B0529019-1", 抵达日期: "2025-06-06", 离开日期: "2025-06-12" },
            { 区域: "保加利亚", 季节: "旺季", 车型: "大巴", 无空: 3.5, 空返: 3.5, 预定价: 1666, 无空日均: 476, 空返日均: 476, 供应商: "索非亚 Union", 参考总价: 1690, 参考日均: 483, 参考总价2: "无", 参考日均2: "无", 团号: "BK2503039A0606018-1", 抵达日期: "2025-06-06", 离开日期: "2025-06-09" },
            { 区域: "奥匈南", 季节: "旺季", 车型: "迷你巴", 无空: 13, 空返: 15, 预定价: 6000, 无空日均: 462, 空返日均: 400, 供应商: "苏博蒂查 Sutravel", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BE2503003B0609019-1", 抵达日期: "2025-06-09", 离开日期: "2025-06-21" },
            { 区域: "奥匈南", 季节: "旺季", 车型: "大巴", 无空: 13, 空返: 15, 预定价: 7200, 无空日均: 554, 空返日均: 480, 供应商: "诺维萨德 RT travel", 参考总价: 7700, 参考日均: 592, 参考总价2: "无", 参考日均2: "无", 团号: "BE2503003B0609019-1", 抵达日期: "2025-06-09", 离开日期: "2025-06-21" },
            { 区域: "斯克", 季节: "旺季", 车型: "大巴", 无空: 12, 空返: 14, 预定价: 8400, 无空日均: 700, 空返日均: 600, 供应商: "诺维萨德 RT travel", 参考总价: 8500, 参考日均: 708, 参考总价2: "无", 参考日均2: "无", 团号: "BK13068A250609025-1", 抵达日期: "2025-06-10", 离开日期: "2025-06-21" },
            { 区域: "德国", 季节: "旺季", 车型: "大巴", 无空: 12.5, 空返: 14.5, 预定价: 11000, 无空日均: 880, 空返日均: 759, 供应商: "布拉格 rosti", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK13106A250610020", 抵达日期: "2025-06-10", 离开日期: "2025-06-22" },
            { 区域: "奥匈南", 季节: "旺季", 车型: "大巴", 无空: 17, 空返: 17, 预定价: 9950, 无空日均: 585, 空返日均: 585, 供应商: "布达佩斯 Kuti", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "EE03033A0622015-1", 抵达日期: "2025-06-13", 离开日期: "2025-06-29" },
            { 区域: "希边境", 季节: "旺季", 车型: "大巴", 无空: 6, 空返: 6, 预定价: 2500, 无空日均: 417, 空返日均: 417, 供应商: "布德瓦 Lalatovic", 参考总价: 2800, 参考日均: 467, 参考总价2: "无", 参考日均2: "无", 团号: "BK2503039A0606018-1", 抵达日期: "2025-06-15", 离开日期: "2025-06-20" },
            { 区域: "冰岛", 季节: "旺季", 车型: "大巴", 无空: 2, 空返: 2, 预定价: 3215, 无空日均: 1608, 空返日均: 1608, 供应商: "雷克雅未克 Gray Line", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "GBT2502044B0611015-1", 抵达日期: "2025-06-15", 离开日期: "2025-06-17" },
            { 区域: "大东欧", 季节: "旺季", 车型: "大巴", 无空: 14, 空返: 17, 预定价: 8200, 无空日均: 586, 空返日均: 482, 供应商: "维尔纽斯 Bondrida", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK13066A250620016-1", 抵达日期: "2025-06-16", 离开日期: "2025-06-29" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "大巴", 无空: 21.5, 空返: 23, 预定价: 8500, 无空日均: 395, 空返日均: 370, 供应商: "贝尔格莱德 ALENIK", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503003A0616021-1", 抵达日期: "2025-06-16", 离开日期: "2025-07-07" },
            { 区域: "奥斯陆", 季节: "旺季", 车型: "大巴", 无空: 1, 空返: 1, 预定价: 950, 无空日均: 950, 空返日均: 950, 供应商: "奥斯陆 Unknown", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "GBT2502044B0611015-1", 抵达日期: "2025-06-17", 离开日期: "2025-06-18" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "大巴", 无空: 22.5, 空返: 24, 预定价: 9500, 无空日均: 422, 空返日均: 396, 供应商: "贝尔格莱德 ALENIK", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503012B0620020-1", 抵达日期: "2025-06-19", 离开日期: "2025-07-11" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "迷你巴", 无空: 22.5, 空返: 24, 预定价: 7780, 无空日均: 346, 空返日均: 324, 供应商: "苏博蒂查 Sutravel", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503012B0620020-1", 抵达日期: "2025-06-19", 离开日期: "2025-07-11" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "大巴", 无空: 21.5, 空返: 23, 预定价: 10500, 无空日均: 488, 空返日均: 457, 供应商: "诺维萨德 RT travel", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503013B0620020-1", 抵达日期: "2025-06-20", 离开日期: "2025-07-11" },
            { 区域: "免三BS", 季节: "旺季", 车型: "迷你巴", 无空: 11, 空返: 12, 预定价: 3600, 无空日均: 327, 空返日均: 300, 供应商: "克拉列沃 ZEKO", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK13108A250625012", 抵达日期: "2025-06-21", 离开日期: "2025-07-01" },
            { 区域: "波三", 季节: "旺季", 车型: "大巴", 无空: 2.5, 空返: 3, 预定价: 1450, 无空日均: 580, 空返日均: 483, 供应商: "里加 LAUVAS", 参考总价: 1790, 参考日均: 716, 参考总价2: 2000, 参考日均2: 667, 团号: "GBT2502044B0622019-1", 抵达日期: "2025-06-22", 离开日期: "2025-06-24" },
            { 区域: "波三", 季节: "旺季", 车型: "迷你巴", 无空: 6.5, 空返: 7, 预定价: 2450, 无空日均: 377, 空返日均: 350, 供应商: "里加 Viva Auto", 参考总价: 3000, 参考日均: 462, 参考总价2: 3570, 参考日均2: 510, 团号: "BT03011A0625012-1", 抵达日期: "2025-06-25", 离开日期: "2025-07-01" },
            { 区域: "免三BB", 季节: "旺季", 车型: "迷你巴", 无空: 7.5, 空返: 7.5, 预定价: 2500, 无空日均: 333, 空返日均: 333, 供应商: "贝尔格莱德 Mons", 参考总价: 2800, 参考日均: 373, 参考总价2: "无", 参考日均2: "无", 团号: "BK13132A250500010", 抵达日期: "2025-06-25", 离开日期: "2025-07-02" },
            { 区域: "波波", 季节: "旺季", 车型: "迷你巴", 无空: 17, 空返: 19, 预定价: 8410, 无空日均: 495, 空返日均: 443, 供应商: "克拉科夫 szwagropol", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BT03003B0626020-1", 抵达日期: "2025-06-26", 离开日期: "2025-07-12" },
            { 区域: "波波", 季节: "旺季", 车型: "大巴", 无空: 17, 空返: 19, 预定价: 8350, 无空日均: 491, 空返日均: 439, 供应商: "维尔纽斯 UAB", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BT03003B0626020-1", 抵达日期: "2025-06-26", 离开日期: "2025-07-12" },
            { 区域: "北欧", 季节: "旺季", 车型: "大巴", 无空: 4.5, 空返: 4.5, 预定价: 4540, 无空日均: 1009, 空返日均: 1009, 供应商: "维尔纽斯 VIP", 参考总价: 5600, 参考日均: 1244, 参考总价2: "无", 参考日均2: "无", 团号: "GNC2502062A0626016", 抵达日期: "2025-06-26", 离开日期: "2025-06-30" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "大巴", 无空: 16.5, 空返: 18, 预定价: 9800, 无空日均: 594, 空返日均: 544, 供应商: "贝尔格莱德 MM Trans", 参考总价: 14000, 参考日均: 848, 参考总价2: "无", 参考日均2: "无", 团号: "BE2503059B0627020-1", 抵达日期: "2025-06-27", 离开日期: "2025-07-13" },
            { 区域: "摩尔多瓦", 季节: "旺季", 车型: "大巴", 无空: 1.8, 空返: 1.8, 预定价: 900, 无空日均: 500, 空返日均: 500, 供应商: "摩尔多瓦 DVD", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK13066A250620016-1", 抵达日期: "2025-06-29", 离开日期: "2025-07-01" },
            { 区域: "奥匈南", 季节: "旺季", 车型: "大巴", 无空: 12.5, 空返: 15, 预定价: 6000, 无空日均: 480, 空返日均: 400, 供应商: "苏博蒂查 Sutravel", 参考总价: 6800, 参考日均: 544, 参考总价2: 9000, 参考日均2: 600, 团号: "BE2503003B0630020-1", 抵达日期: "2025-06-30", 离开日期: "2025-07-12" },
            { 区域: "北欧", 季节: "旺季", 车型: "大巴", 无空: 13, 空返: 14, 预定价: 11950, 无空日均: 919, 空返日均: 853, 供应商: "维尔纽斯 Ollex", 参考总价: 13705, 参考日均: 1054, 参考总价2: "无", 参考日均2: "无", 团号: "GNE2502013A0702016+1", 抵达日期: "2025-07-02", 离开日期: "2025-07-14" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "大巴", 无空: 21.5, 空返: 23, 预定价: 10500, 无空日均: 488, 空返日均: 457, 供应商: "诺维萨德 RT travel", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503003A0703020-1", 抵达日期: "2025-07-03", 离开日期: "2025-07-24" },
            { 区域: "免三BB", 季节: "旺季", 车型: "大巴", 无空: 7.5, 空返: 7.5, 预定价: 3100, 无空日均: 413, 空返日均: 413, 供应商: "贝尔格莱德 ALENIK", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK13070A250707020-1", 抵达日期: "2025-07-06", 离开日期: "2025-07-13" },
            { 区域: "北欧", 季节: "旺季", 车型: "大巴", 无空: 8, 空返: 9.5, 预定价: 8351, 无空日均: 1044, 空返日均: 879, 供应商: "维尔纽斯 Ollex", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "GNE2502013A0707060", 抵达日期: "2025-07-07", 离开日期: "2025-07-14" },
            { 区域: "免三BB", 季节: "旺季", 车型: "迷你巴", 无空: 7.5, 空返: 7.5, 预定价: 2300, 无空日均: 307, 空返日均: 307, 供应商: "克拉列沃 ZEKO", 参考总价: 2400, 参考日均: 320, 参考总价2: 2635, 参考日均2: 351, 团号: "BK13166A250623015-1", 抵达日期: "2025-07-12", 离开日期: "2025-07-19" },
            { 区域: "克罗地亚", 季节: "旺季", 车型: "大巴", 无空: 5, 空返: 5.5, 预定价: 2800, 无空日均: 560, 空返日均: 509, 供应商: "萨格勒布 Mandi", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK13112A250717020", 抵达日期: "2025-07-18", 离开日期: "2025-07-22" },
            { 区域: "奥匈南", 季节: "旺季", 车型: "迷你巴", 无空: 14.5, 空返: 16, 预定价: 5600, 无空日均: 386, 空返日均: 350, 供应商: "贝尔格莱德 Mons", 参考总价: 5700, 参考日均: 393, 参考总价2: "无", 参考日均2: "无", 团号: "BK13188A230719010", 抵达日期: "2025-07-19", 离开日期: "2025-08-02" },
            { 区域: "德国", 季节: "旺季", 车型: "大巴", 无空: 14, 空返: 15, 预定价: 8400, 无空日均: 600, 空返日均: 560, 供应商: "里苏蒂ROSTISLAV", 参考总价: 9800, 参考日均: 700, 参考总价2: "无", 参考日均2: "无", 团号: "EE2503042B0728040-2", 抵达日期: "2025-07-27", 离开日期: "2025-08-09" },
            { 区域: "波三", 季节: "旺季", 车型: "迷你巴", 无空: 7, 空返: 7, 预定价: 2450, 无空日均: 350, 空返日均: 350, 供应商: "里加 Viva Auto", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BT03011A0723008-1", 抵达日期: "2025-07-30", 离开日期: "2025-08-05" },
            { 区域: "免三BS", 季节: "旺季", 车型: "大巴", 无空: 7.5, 空返: 8, 预定价: 2340, 无空日均: 312, 空返日均: 293, 供应商: "萨拉热窝 Farre", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK13185V250805015", 抵达日期: "2025-08-05", 离开日期: "2025-08-12" },
            { 区域: "河轮", 季节: "旺季", 车型: "大巴", 无空: 16, 空返: 17, 预定价: 9200, 无空日均: 575, 空返日均: 541, 供应商: "诺维萨德 RT travel", 参考总价: 9600, 参考日均: 600, 参考总价2: "无", 参考日均2: "无", 团号: "BE2503003B0809030-1", 抵达日期: "2025-08-09", 离开日期: "2025-08-24" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "大巴", 无空: 21.5, 空返: 23, 预定价: 9800, 无空日均: 456, 空返日均: 426, 供应商: "贝尔格莱德 ALENIK", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503003A0811020-1", 抵达日期: "2025-08-11", 离开日期: "2025-09-01" },
            { 区域: "波兰", 季节: "旺季", 车型: "大巴", 无空: 6, 空返: 6, 预定价: 3000, 无空日均: 500, 空返日均: 500, 供应商: "克拉科夫 szwagropol", 参考总价: 3150, 参考日均: 525, 参考总价2: 3200, 参考日均2: 533, 团号: "BT13238A250824015", 抵达日期: "2025-08-24", 离开日期: "2025-08-29" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "大巴", 无空: 14.5, 空返: 16, 预定价: 7500, 无空日均: 517, 空返日均: 469, 供应商: "贝尔格莱德 ALENIK", 参考总价: 9200, 参考日均: 634, 参考总价2: 9500, 参考日均2: 594, 团号: "BK2503012B0829015-1", 抵达日期: "2025-08-29", 离开日期: "2025-09-12" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "迷你巴", 无空: 21.5, 空返: 23, 预定价: 7000, 无空日均: 326, 空返日均: 304, 供应商: "贝尔格莱德 Pexon", 参考总价: 7260, 参考日均: 338, 参考总价2: 7800, 参考日均2: 339, 团号: "BK2503003A0907020-0", 抵达日期: "2025-09-07", 离开日期: "2025-09-28" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "大巴", 无空: 21.5, 空返: 23, 预定价: 9800, 无空日均: 456, 空返日均: 426, 供应商: "诺维萨德 RT travel", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503003A0907020-1", 抵达日期: "2025-09-07", 离开日期: "2025-09-28" },
            { 区域: "波波", 季节: "旺季", 车型: "大巴", 无空: 14, 空返: 16, 预定价: 7000, 无空日均: 500, 空返日均: 438, 供应商: "华沙 RafTrans", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK13156A250830016", 抵达日期: "2025-09-10", 离开日期: "2025-09-23" },
            { 区域: "波波", 季节: "旺季", 车型: "大巴", 无空: 17, 空返: 19, 预定价: 8100, 无空日均: 476, 空返日均: 426, 供应商: "塔林 UAB", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BT03003B0910020-1", 抵达日期: "2025-09-10", 离开日期: "2025-09-26" },
            { 区域: "波兰", 季节: "旺季", 车型: "大巴", 无空: 3.5, 空返: 3.5, 预定价: 2250, 无空日均: 643, 空返日均: 643, 供应商: "克拉科夫 szwagropol", 参考总价: 2500, 参考日均: 714, 参考总价2: "无", 参考日均2: "无", 团号: "GEE2502004A0912030", 抵达日期: "2025-09-13", 离开日期: "2025-09-16" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "大巴", 无空: 14.5, 空返: 16, 预定价: 7000, 无空日均: 483, 空返日均: 438, 供应商: "诺维萨德 RT travel", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "EE2503012C0918020-1", 抵达日期: "2025-09-18", 离开日期: "2025-10-02" },
            { 区域: "斯克", 季节: "旺季", 车型: "迷你巴", 无空: 14, 空返: 15, 预定价: 6100, 无空日均: 436, 空返日均: 407, 供应商: "萨格勒布 Ibus", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "GBK2502067V0926006", 抵达日期: "2025-09-26", 离开日期: "2025-10-09" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "大巴", 无空: 21.5, 空返: 23, 预定价: 9800, 无空日均: 456, 空返日均: 426, 供应商: "诺维萨德 RT travel", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503003A1003020-1", 抵达日期: "2025-10-03", 离开日期: "2025-10-24" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "大巴", 无空: 21.5, 空返: 23, 预定价: 12000, 无空日均: 558, 空返日均: 522, 供应商: "萨拉热窝 VILDAN", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503012B01005020-1", 抵达日期: "2025-10-05", 离开日期: "2025-10-26" },
            { 区域: "巴尔干", 季节: "旺季", 车型: "中巴", 无空: 21.5, 空返: 23, 预定价: 9560, 无空日均: 445, 空返日均: 416, 供应商: "贝尔格莱德 Mons", 参考总价: "无", 参考日均: "无", 参考总价2: "无", 参考日均2: "无", 团号: "BK2503012B01005020-1", 抵达日期: "2025-10-05", 离开日期: "2025-10-26" },
            { 区域: "奥克", 季节: "旺季", 车型: "大巴", 无空: 9.5, 空返: 11, 预定价: 5500, 无空日均: 579, 空返日均: 500, 供应商: "萨格勒布 Molnar", 参考总价: 5600, 参考日均: 589, 参考总价2: 6350, 参考日均2: 577, 团号: "BK13068A251007010-2", 抵达日期: "2025-10-07", 离开日期: "2025-10-16" },
            { 区域: "东欧", 季节: "旺季", 车型: "大巴", 无空: 13.5, 空返: 16, 预定价: 7600, 无空日均: 563, 空返日均: 475, 供应商: "克拉科夫 szwagropol", 参考总价: 8680, 参考日均: 643, 参考总价2: 9100, 参考日均2: 569, 团号: "EE2503008A1013020-1", 抵达日期: "2025-10-18", 离开日期: "2025-10-31" }
        ];

        // Login function
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === 'KK' && password === '147258') {
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('mainContainer').style.display = 'block';
                initializePage();
            } else {
                alert('用户名或密码错误！');
            }
        }

        // Initialize page after login
        function initializePage() {
            populateDropdowns();
            renderTable(data);
            updateSummary(data);
        }

        // Populate dropdown filters with unique values
        function populateDropdowns() {
            const regions = [...new Set(data.map(item => item.区域))];
            const suppliers = [...new Set(data.map(item => item.供应商))];
            const groupNumbers = [...new Set(data.map(item => item.团号))];
            
            const regionFilter = document.getElementById('region-filter');
            const supplierFilter = document.getElementById('supplier-filter');
            const groupFilter = document.getElementById('group-filter');
            
            regions.forEach(region => {
                const option = document.createElement('option');
                option.value = region;
                option.textContent = region;
                regionFilter.appendChild(option);
            });
            
            suppliers.forEach(supplier => {
                const option = document.createElement('option');
                option.value = supplier;
                option.textContent = supplier;
                supplierFilter.appendChild(option);
            });
            
            groupNumbers.forEach(group => {
                const option = document.createElement('option');
                option.value = group;
                option.textContent = group;
                groupFilter.appendChild(option);
            });
            
            // Add event listeners to filters
            document.getElementById('region-filter').addEventListener('change', applyFilters);
            document.getElementById('season-filter').addEventListener('change', applyFilters);
            document.getElementById('type-filter').addEventListener('change', applyFilters);
            document.getElementById('supplier-filter').addEventListener('change', applyFilters);
            document.getElementById('group-filter').addEventListener('change', applyFilters);
        }

        // Apply filters based on dropdown selections
        function applyFilters() {
            const regionFilter = document.getElementById('region-filter').value;
            const seasonFilter = document.getElementById('season-filter').value;
            const typeFilter = document.getElementById('type-filter').value;
            const supplierFilter = document.getElementById('supplier-filter').value;
            const groupFilter = document.getElementById('group-filter').value;
            
            const filteredData = data.filter(item => {
                return (regionFilter === '' || item.区域 === regionFilter) &&
                       (seasonFilter === '' || item.季节 === seasonFilter) &&
                       (typeFilter === '' || item.车型 === typeFilter) &&
                       (supplierFilter === '' || item.供应商 === supplierFilter) &&
                       (groupFilter === '' || item.团号 === groupFilter);
            });
            
            renderTable(filteredData);
            updateSummary(filteredData);
            updateActiveFiltersDisplay(regionFilter, seasonFilter, typeFilter, supplierFilter, groupFilter);
        }

        // Reset all filters
        function resetFilters() {
            document.getElementById('region-filter').value = '';
            document.getElementById('season-filter').value = '';
            document.getElementById('type-filter').value = '';
            document.getElementById('supplier-filter').value = '';
            document.getElementById('group-filter').value = '';
            
            applyFilters();
        }

        // Update the active filters display
        function updateActiveFiltersDisplay(region, season, type, supplier, group) {
            const filtersDisplay = document.getElementById('filters-display');
            filtersDisplay.innerHTML = '';
            
            const activeFilters = [];
            if (region) activeFilters.push(`区域: ${region}`);
            if (season) activeFilters.push(`季节: ${season}`);
            if (type) activeFilters.push(`车型: ${type}`);
            if (supplier) activeFilters.push(`供应商: ${supplier}`);
            if (group) activeFilters.push(`团号: ${group}`);
            
            if (activeFilters.length === 0) {
                filtersDisplay.textContent = '无';
            } else {
                activeFilters.forEach(filter => {
                    const span = document.createElement('span');
                    span.textContent = filter;
                    filtersDisplay.appendChild(span);
                });
            }
        }

        // Render the data table
        function renderTable(data) {
            const tableBody = document.getElementById('table-body');
            tableBody.innerHTML = '';
            
            data.forEach(item => {
                const row = document.createElement('tr');
                
                // Format numbers to integers
                const 预定价 = item.预定价 === "无" ? "无" : `€${Math.round(item.预定价)}`;
                const 无空日均 = item.无空日均 === "无" ? "无" : `€${Math.round(item.无空日均)}`;
                const 空返日均 = item.空返日均 === "无" ? "无" : `€${Math.round(item.空返日均)}`;
                const 参考总价 = item.参考总价 === "无" ? "无" : `€${Math.round(item.参考总价)}`;
                const 参考日均 = item.参考日均 === "无" ? "无" : `€${Math.round(item.参考日均)}`;
                const 参考总价2 = item.参考总价2 === "无" ? "无" : `€${Math.round(item.参考总价2)}`;
                const 参考日均2 = item.参考日均2 === "无" ? "无" : `€${Math.round(item.参考日均2)}`;
                
                row.innerHTML = `
                    <td class="fixed-column">${item.区域}</td>
                    <td class="fixed-column-season">${item.季节}</td>
                    <td class="fixed-column-type">${item.车型}</td>
                    <td>${item.无空}</td>
                    <td>${item.空返}</td>
                    <td>${预定价}</td>
                    <td>${无空日均}</td>
                    <td class="empty-return">${空返日均}</td>
                    <td>${item.供应商}</td>
                    <td>${参考总价}</td>
                    <td>${参考日均}</td>
                    <td>${参考总价2}</td>
                    <td>${参考日均2}</td>
                    <td>${item.团号}</td>
                    <td>${item.抵达日期}</td>
                    <td>${item.离开日期}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // Update the summary box with average empty return price
        function updateSummary(data) {
            const emptyReturns = data
                .filter(item => typeof item.空返日均 === 'number')
                .map(item => item.空返日均);
            
            const average = emptyReturns.length > 0 
                ? Math.round(emptyReturns.reduce((a, b) => a + b, 0) / emptyReturns.length)
                : 0;
            
            document.getElementById('empty-return-summary').textContent = `€${average}`;
        }

        // Scroll to top function
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }
    </script>
</body>
</html>